"use strict";(self.webpackChunkpackit_dev=self.webpackChunkpackit_dev||[]).push([[8452],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(n),h=a,m=c["".concat(l,".").concat(h)]||c[h]||f[h]||i;return n?r.createElement(m,o(o({ref:t},p),{},{components:n})):r.createElement(m,o({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,o[1]=s;for(var u=2;u<i;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},47382:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>f,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var r=n(87462),a=(n(67294),n(3905));const i={title:"Running tests with builds from another PR",date:new Date("2022-12-21T00:00:00.000Z"),authors:"fnecas",tags:["testing-farm"]},o=void 0,s={permalink:"/posts/testing-farm-triggering",editUrl:"https://github.com/packit/packit.dev/tree/main/posts/testing-farm-triggering/index.md",source:"@site/posts/testing-farm-triggering/index.md",title:"Running tests with builds from another PR",description:"Do you contribute to projects which depend on each other?",date:"2022-12-21T00:00:00.000Z",formattedDate:"December 21, 2022",tags:[{label:"testing-farm",permalink:"/posts/tags/testing-farm"}],readingTime:2.185,hasTruncateMarker:!0,authors:[{name:"Franti\u0161ek Ne\u010das",url:"https://github.com/FrNecas",imageURL:"https://github.com/FrNecas.png",key:"fnecas"}],frontMatter:{title:"Running tests with builds from another PR",date:"2022-12-21T00:00:00.000Z",authors:"fnecas",tags:["testing-farm"]},prevItem:{title:"Automatic pulling of upstream releases to Fedora",permalink:"/posts/pull-from-upstream"},nextItem:{title:"Automation of FAS verification in Packit Service",permalink:"/posts/fas-verification-automation"}},l={authorsImageUrls:[void 0]},u=[{value:"How it works",id:"how-it-works",level:3},{value:"Wrapping up",id:"wrapping-up",level:3}],p={toc:u},c="wrapper";function f(e){let{components:t,...i}=e;return(0,a.kt)(c,(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Do you contribute to projects which depend on each other?\nWould you like to test changes spanning multiple repositories together before merging them to the main branch?\nThen look no further, Packit's new feature of the Testing Farm integration is what you are looking for!"),(0,a.kt)("h3",{id:"how-it-works"},"How it works"),(0,a.kt)("p",null,"To enable such testing, there is no additional configuration required in your ",(0,a.kt)("inlineCode",{parentName:"p"},"packit.yaml"),", the typical ",(0,a.kt)("a",{parentName:"p",href:"/docs/testing-farm/"},"Testing Farm configuration")," is sufficient.\nOnce you open a pull request with some changes, tests are going to run as usual with all dependencies being installed based on the test definition, e.g. from Fedora repositories.\nTo trigger tests with builds from a pull request in another repository, add a comment to the pull request of the form:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"/packit test <namespace>/<repo>#<pr-id>\n")),(0,a.kt)("p",null,"Based on this comment, Testing Farm will first install the recent successful builds created by Packit in the given pull request and then run the tests.\nIn order for this to work, there must be successful builds for the targets that you are running tests for.\nFor example, if you are testing against Fedora 36, the pull request that you want to install builds from must contain a successful Fedora 36 build by Packit."),(0,a.kt)("p",null,"Let's look at a simple example to demonstrate this feature better.\nThe Packit CLI uses a library called ",(0,a.kt)("inlineCode",{parentName:"p"},"specfile")," to modify RPM spec files.\nRecently, ",(0,a.kt)("inlineCode",{parentName:"p"},"specfile")," has added a new feature which makes accessing the ",(0,a.kt)("inlineCode",{parentName:"p"},"Epoch")," field in the spec file more convenient and we would like to make use of this feature.\nHowever, the changes have not made it to a Fedora release yet, trying to use this feature will result in an error:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Tests in Testing Farm fail",src:n(31272).Z,width:"1091",height:"786"})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Test log in Testing Farm",src:n(21596).Z,width:"978",height:"353"})),(0,a.kt)("p",null,"As we can see in the screenshots, during artifact installation, the latest ",(0,a.kt)("inlineCode",{parentName:"p"},"specfile")," release from Fedora was installed, however it lacks the feature that we are looking to test.\nLet's now retrigger the tests, but specify that we want to install builds from the pull request in ",(0,a.kt)("inlineCode",{parentName:"p"},"specfile")," which introduced the changes:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Retriggering tests with builds from another PR",src:n(75274).Z,width:"1095",height:"727"})),(0,a.kt)("p",null,"Hooray! The copr builds from PR 165 were installed before the tests were run in Testing Farm which enabled us to test the feature inside Packit CLI."),(0,a.kt)("h3",{id:"wrapping-up"},"Wrapping up"),(0,a.kt)("p",null,"We hope that this new feature makes upstream testing even more convenient than it previously was.\nThe feature is still quite new, and we would love to hear what you think about it.\nAs always, if you run into any trouble or have any ideas how to improve this functionality,\ndo not hesitate to ",(0,a.kt)("a",{parentName:"p",href:"/#contact"},"reach out to us"),".\nWe will be happy to help."))}f.isMDXComponent=!0},31272:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/testing_farm_failed-f53ec0611bf89aee0e9eedd30a992814.png"},21596:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/testing_farm_failed_log-b4f3f67d4ae5d36021eda7ef2f9d0030.png"},75274:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/testing_farm_retrigger-b67508e5263e2ee7f49b367670fcdd80.png"}}]);