"use strict";(self.webpackChunkpackit_dev=self.webpackChunkpackit_dev||[]).push([[5860],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>m});var o=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t){if(null==e)return{};var a,o,r=function(e,t){if(null==e)return{};var a,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=o.createContext({}),p=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},u=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=n(e,["components","mdxType","originalType","parentName"]),d=p(a),h=r,m=d["".concat(l,".").concat(h)]||d[h]||c[h]||i;return a?o.createElement(m,s(s({ref:t},u),{},{components:a})):o.createElement(m,s({ref:t},u))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,s=new Array(i);s[0]=h;var n={};for(var l in t)hasOwnProperty.call(t,l)&&(n[l]=t[l]);n.originalType=e,n[d]="string"==typeof e?e:r,s[1]=n;for(var p=2;p<i;p++)s[p]=a[p];return o.createElement.apply(null,s)}return o.createElement.apply(null,a)}h.displayName="MDXCreateElement"},61614:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>i,metadata:()=>n,toc:()=>p});var o=a(87462),r=(a(67294),a(3905));const i={title:"2022 for Packit",date:new Date("2023-01-28T10:58:50.000Z"),authors:"flachman",tags:[2022,"yearly-features","summary"]},s=void 0,n={permalink:"/posts/2022-features",editUrl:"https://github.com/packit/packit.dev/tree/main/posts/2022-features/index.md",source:"@site/posts/2022-features/index.md",title:"2022 for Packit",description:"As you will see in the following paragraphs, the year 2022 was really fruitful for the Packit project. Without further ado, let\u2019s take a look at what the Packit team accomplished last year!",date:"2023-01-28T10:58:50.000Z",formattedDate:"January 28, 2023",tags:[{label:"2022",permalink:"/posts/tags/2022"},{label:"yearly-features",permalink:"/posts/tags/yearly-features"},{label:"summary",permalink:"/posts/tags/summary"}],readingTime:7.285,hasTruncateMarker:!0,authors:[{name:"Franti\u0161ek Lachman",email:"flachman@redhat.com",url:"https://github.com/lachmanfrantisek",imageURL:"https://github.com/lachmanfrantisek.png",key:"flachman"}],frontMatter:{title:"2022 for Packit",date:"2023-01-28T10:58:50.000Z",authors:"flachman",tags:["2022","yearly-features","summary"]},prevItem:{title:"Packit's pre-commit hooks",permalink:"/posts/pre-commit-hooks"},nextItem:{title:"Automatic pulling of upstream releases to Fedora",permalink:"/posts/pull-from-upstream"}},l={authorsImageUrls:[void 0]},p=[{value:"Fedora automation",id:"fedora-automation",level:2},{value:"SRPM in Copr",id:"srpm-in-copr",level:2},{value:"Self-mapping of FAS account",id:"self-mapping-of-fas-account",level:2},{value:"Multiple-project test runs",id:"multiple-project-test-runs",level:2},{value:"Specfile library",id:"specfile-library",level:2},{value:"VM Image Builds",id:"vm-image-builds",level:2},{value:"Plans for the next year",id:"plans-for-the-next-year",level:2}],u={toc:p},d="wrapper";function c(e){let{components:t,...i}=e;return(0,r.kt)(d,(0,o.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"As you will see in the following paragraphs, the year 2022 was really fruitful for the Packit project. Without further ado, let\u2019s take a look at what the Packit team accomplished last year!"),(0,r.kt)("h2",{id:"fedora-automation"},"Fedora automation"),(0,r.kt)("p",null,"We have made a huge improvement in downstream automation. At the beginning of the year, we ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/posts/downstream-automation/"},"finished the workflow")," and you are now able to use Packit to get your release from upstream via dist-git and Koji to Bodhi. As usual, you can pick just what you need. This workflow consists of three jobs:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"propose-downstream"),": as a reaction to an upstream release, the source archive is saved to a lookaside cache, specfile is updated and sent as a pull request to Fedora dist-git."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"koji-build"),": as a reaction to a new dist-git commit, a new Koji build is triggered (you can specify allowed authors of a commit or merged pull request)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bodhi-update"),": as a reaction to a successfully finished Koji build, a new Bodhi update is created")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Detail of a Bodhi update created by Packit",src:a(5939).Z,width:"851",height:"477"})),(0,r.kt)("p",null,"But that wasn\u2019t all. At the very end of the year, the Packit team implemented an alternative to the ",(0,r.kt)("inlineCode",{parentName:"p"},"propose-downstream")," job that we call ",(0,r.kt)("inlineCode",{parentName:"p"},"pull-from-upstream"),". The logic of the job is the very same: the source archive is saved to a lookaside cache, specfile is updated and sent as a pull request to Fedora dist-git. The only \u2013 and main \u2013 difference is that the job is defined downstream (in the default dist-git branch, ",(0,r.kt)("inlineCode",{parentName:"p"},"rawhide")," or its ",(0,r.kt)("inlineCode",{parentName:"p"},"main")," alias) so you don\u2019t need to install Packit in the upstream repository. The information about a new release is received from the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring"},"Upstream Release Monitoring"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"pull-from-upstream")," job is mainly targeted to the Fedora maintainers without upstream access or with upstream not being supported by Packit. (This job works with any upstream using git.) The setup is nicely described in ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/posts/pull-from-upstream"},"this blog post"),". And if you want a dedicated documentation page for the Fedora downstream automation, look at ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/docs/fedora-releases-guide/"},"https://packit.dev/docs/fedora-releases-guide/"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Pull request created by a pull-from-upstream workflow",src:a(64035).Z,width:"1089",height:"886"})),(0,r.kt)("p",null,"And that\u2019s still not all, we\u2019ve also added ",(0,r.kt)("inlineCode",{parentName:"p"},"propose-downstream")," to ",(0,r.kt)("a",{parentName:"p",href:"https://dashboard.packit.dev"},"our dashboard"),". You can now the jobs in ",(0,r.kt)("a",{parentName:"p",href:"https://dashboard.packit.dev/pipelines"},"the Pipelines view"),". Also, logs can be checked on a detail page (that can be accessed from a status of a release commit)."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Propose downstream result page",src:a(83006).Z,width:"887",height:"617"})),(0,r.kt)("p",null,"Still not convinced we\u2019ve done a lot? When using various downstream jobs, you can still hit an issue now and then. (Messages from Fedora infrastructure can get lost or some intermittent error can occur.) Packit automatically retries to overcome temporary issues, but sometimes it\u2019s not enough or there is a real problem that needs to be fixed elsewhere. We can\u2019t resolve the real problems for you, but we can help let you retry the job when needed. And you have two places where to do that."),(0,r.kt)("p",null,"As you might be used to with the ",(0,r.kt)("inlineCode",{parentName:"p"},"propose-downstream")," job, you can use comments in an upstream issue to retrigger Bodhi updates and Koji builds as well. Just configure ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/docs/configuration/#issue_repository"},(0,r.kt)("inlineCode",{parentName:"a"},"issue_repository"))," so Packit knows where to create issues in case of problems. (This does not need to be an upstream issue and this repository can be used for multiple projects.) Alternatively, if you use dist-git pull requests (either made by Packit or other maintainers), you can use a pull request comment to retrigger Koji Build or Bodhi update."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Comment to recreate a Bodhi update",src:a(59661).Z,width:"735",height:"510"})),(0,r.kt)("p",null,"If you are interested in what Packit has done for its users, you can take a look at the activity of the ",(0,r.kt)("inlineCode",{parentName:"p"},"packit")," (or ",(0,r.kt)("inlineCode",{parentName:"p"},"packit-stg"),") FAS user in ",(0,r.kt)("a",{parentName:"p",href:"https://src.fedoraproject.org/user/packit"},"dist-git"),", ",(0,r.kt)("a",{parentName:"p",href:"https://koji.fedoraproject.org/koji/userinfo?userID=4641"},"Koji")," or ",(0,r.kt)("a",{parentName:"p",href:"https://bodhi.fedoraproject.org/users/packit"},"Bodhi"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Dist-git activity of Packit user",src:a(9372).Z,width:"1105",height:"389"}),"\n",(0,r.kt)("img",{alt:"Koji builds triggered by Packit user",src:a(10803).Z,width:"1087",height:"374"}),"\n",(0,r.kt)("img",{alt:"Bodhi updates created by Packit user",src:a(75765).Z,width:"1126",height:"327"})),(0,r.kt)("h2",{id:"srpm-in-copr"},"SRPM in Copr"),(0,r.kt)("p",null,"Throughout the 2022 we have implemented support for building SRPMs in the Copr and slowly started introducing newly-onboarded projects to use Copr right from the start. The definitive switch to Copr has been done at the beginning of 2023. For more details, take a look at the ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/posts/copr-srpms/"},"relevant blog post"),", but let\u2019s shortly describe the benefits:\nMost importantly, you can now use ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/docs/configuration/#srpm_build_deps"},(0,r.kt)("inlineCode",{parentName:"a"},"srpm_build_deps"))," config option to specify the dependencies needed for the build. With the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/packit/sandcastle"},"old solution"),", this process was manual, global and had to be done by Packit maintainers. Another advantage of being able to use Copr for SRPM builds is access to the SRPM artifacts."),(0,r.kt)("h2",{id:"self-mapping-of-fas-account"},"Self-mapping of FAS account"),(0,r.kt)("p",null,"From the beginning of the Packit project, for every Packit GitHub installation, we have required a Fedora account so we can be sure, that we are safe to use Fedora systems (like Copr or dist-git) on behalf of that user. Since we automate various tasks for you, we\u2019ve made it possible for you to perform this yourself. (Thanks to the user config field in the Fedora Account System.)\nIf you are interested in how this works, take a look at the blog post we\u2019ve prepared for you: ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/posts/fas-verification-automation/"},"https://packit.dev/posts/fas-verification-automation/")),(0,r.kt)("p",null,"If you wonder why we check permissions for the installation, we have good news for you. This year, we plan to improve the permission schema, do the checks for each job, and require only what is needed. But more about the plans for 2023 later."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Self-mapping process in an issue",src:a(34361).Z,width:"932",height:"397"})),(0,r.kt)("h2",{id:"multiple-project-test-runs"},"Multiple-project test runs"),(0,r.kt)("p",null,"If you have multiple connected projects (as we do) and work on a feature spanning more of them, the following feature might come in handy. You can use a commit command with a reference to the other pull request and Packit will use Copr builds from both pull requests during the tests. Want to know more? Check this blog post: ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/posts/testing-farm-triggering/"},"https://packit.dev/posts/testing-farm-triggering/")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Test with external build",src:a(86284).Z,width:"923",height:"884"})),(0,r.kt)("h2",{id:"specfile-library"},"Specfile library"),(0,r.kt)("p",null,"This one might not be relevant to most of our users, but we would still like to announce, that we\u2019ve created ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/packit/specfile"},"a Python library")," for specfile manipulation. It can not only parse various weird spec files but also can edit them with as little diff as possible. Also, the code is really interesting so check it out. Now, it\u2019s used by Packit and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/rebase-helper/rebase-helper"},"rebase-helper")," and you can watch ",(0,r.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=yzMfBPdFXZY&t=17s"},"this demo")," if you want to know more.\nIn case you\u2019ve missed that, this is not the first time we\u2019ve extracted a part of our codebase for wider usage \u2013 another nice example is a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/packit/ogr/"},"forge-independent Python library for GitHub/GitLab/Pagure API called OGR"),"."),(0,r.kt)("h2",{id:"vm-image-builds"},"VM Image Builds"),(0,r.kt)("p",null,"Having Copr builds available for your pull-requests is really nice, but you can now have VM image builds as well. It would be really wasteful to do this for each and every commit so we decided to trigger this by a ",(0,r.kt)("inlineCode",{parentName:"p"},"/packit vm-image-build ")," comment. Similarly to other jobs, Packit uses an external system to do the hard work. This feature is possible thanks to the ",(0,r.kt)("a",{parentName:"p",href:"https://console.redhat.com/insights/image-builder"},"Red Hat Image Builder"),". This feature is a fresh start on this journey and we are investigating the possibilities of Packit in this field. Check ",(0,r.kt)("a",{parentName:"p",href:"https://packit.dev/docs/configuration/upstream/vm_image_build"},"our documentation")," and let us know what you think."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"VM image build as a result of the comment",src:a(85492).Z,width:"1103",height:"820"})),(0,r.kt)("h2",{id:"plans-for-the-next-year"},"Plans for the next year"),(0,r.kt)("p",null,"Do you wonder what we plan for you for the year 2023? That is not a secret. For some time, we have been opening our planning and since the last year, you can check our ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/orgs/packit/projects/7/"},"Kanban board")," since it has become the primary place we use on daily bases. (It used to be half-manually and half-automatically synced.)\nEvery quarter, our team sits down and discusses our plans for the next three months. We use MOSCOW (=MUST x SHOULD x COULD x WON\u2019T) prioritisation method to group and compare all of our epics. The result of this time\u2019s planning can be seen ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/orgs/packit/projects/7/views/25"},"here"),"."),(0,r.kt)("p",null,"Do you want to know how we decide and how you can influence us? It\u2019s pretty easy. Firstly, we need to know about a bug or feature request. Secondly, the task needs to be worth the work. (And should be related to our mission.) We can\u2019t work on everything so we need to pick the work with a bigger impact (a lot of projects will benefit from that or a significant benefit for a smaller group). So shortly, if you want something to be done: create an issue, provide a clear reasoning why we should do that and find other projects that can benefit from that."),(0,r.kt)("p",null,"And also, our project is open source. We are more than happy to help anyone contribute to our code base!"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"With that, I, personally, would like to thank all of the Packit team members for their outstanding work during the year. And I also would like to thank you, our users, for using our project, being kind, helpful and patient! I wish you all a happy new year and less mundane work as possible!"),(0,r.kt)("p",null,"On behalf of the Packit team,\nFranti\u0161ek"))}c.isMDXComponent=!0},5939:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/bodhi-update-b24d047f5572831c4ad8de446cf81148.png"},59661:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/dist-git-pull-request-comment-61dc300ce80bfec8c7ec5dd2baf20c92.png"},75765:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/packit-bodhi-updates-all-5b9ac688507f64dafe5284c5e9c7a4a9.png"},9372:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/packit-dist-git-activity-b6d823fb44b606593470d5657524a98d.png"},10803:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/packit-koji-builds-24b249549037f0d79822c9e851211e09.png"},83006:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/propose-downstream-result-page-a2d517abb0153c630f4f03b2ad8ccda5.png"},64035:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/pull-from-upstream-75eca73c81b62ad029f0c029f0b4e557.png"},86284:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/test-for-external-build-90b12f4f5294499b998234a477d6dbd8.png"},85492:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/vm-image-build-9778abe48e8d422ff8863368f4df2930.png"},34361:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/verify-fas-355a7111420aea52229c20f33a86322c.png"}}]);