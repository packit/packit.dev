"use strict";(self.webpackChunkpackit_dev=self.webpackChunkpackit_dev||[]).push([[20299],{15680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>m});var r=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),g=i,m=u["".concat(s,".").concat(g)]||u[g]||d[g]||o;return n?r.createElement(m,a(a({ref:t},c),{},{components:n})):r.createElement(m,a({ref:t},c))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:i,a[1]=l;for(var p=2;p<o;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},57791:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=n(58168),i=(n(96540),n(15680));const o={title:"Clusters"},a=void 0,l={unversionedId:"specifics/clusters",id:"specifics/clusters",title:"Clusters",description:"Automotive \u2192 MP+",source:"@site/deployment/specifics/clusters.md",sourceDirName:"specifics",slug:"/specifics/clusters",permalink:"/deployment/specifics/clusters",draft:!1,editUrl:"https://github.com/packit/deployment/tree/main/docs/deployment/specifics/clusters.md",tags:[],version:"current",frontMatter:{title:"Clusters"},sidebar:"autogenerated",previous:{title:"CentOS Stream",permalink:"/deployment/specifics/centos-stream-source-git"},next:{title:"Fedora Source-git",permalink:"/deployment/specifics/fedora-source-git"}},s={},p=[{value:"Automotive \u2192 MP+",id:"automotive--mp",level:2},{value:"Namespaces",id:"namespaces",level:3},{value:"Postgres",id:"postgres",level:3},{value:"Logging",id:"logging",level:3},{value:"Firewall",id:"firewall",level:3},{value:"Requesting firewall rules",id:"requesting-firewall-rules",level:4},{value:"Template and notes",id:"template-and-notes",level:4}],c={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,i.yg)(u,(0,r.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"automotive--mp"},"Automotive \u2192 MP+"),(0,i.yg)("p",null,"Currently we are moving from the Automotive cluster to the MP+ cluster. Our\nstaging deployment is already present on the MP+ and there were some differences\nintroduced once the migration started."),(0,i.yg)("h3",{id:"namespaces"},"Namespaces"),(0,i.yg)("p",null,"Previously we have used a rather simple ",(0,i.yg)("inlineCode",{parentName:"p"},"packit-{{ deployment }}")," namespace. On\nMP+ we are given ",(0,i.yg)("inlineCode",{parentName:"p"},"packit")," as a tenant prefix, that needs to be separated from\nour custom namespaces by ",(0,i.yg)("inlineCode",{parentName:"p"},"--"),", therefore we use ",(0,i.yg)("inlineCode",{parentName:"p"},"packit--stg")," and\n",(0,i.yg)("inlineCode",{parentName:"p"},"packit--stg-sandbox"),"."),(0,i.yg)("h3",{id:"postgres"},"Postgres"),(0,i.yg)("p",null,"On MP+ we have also moved to the newer postgres image, specifically we have used\nv13 and moved on to the v15."),(0,i.yg)("h3",{id:"logging"},"Logging"),(0,i.yg)("p",null,"On Automotive cluster we're using fluentd-sidecar to upload the logs to the\nSplunk. Within the MP+ cluster we don't need to, since the logs can be output to\nthe ",(0,i.yg)("inlineCode",{parentName:"p"},"stdout")," and are logged implicitly."),(0,i.yg)("h3",{id:"firewall"},"Firewall"),(0,i.yg)("p",null,"Outgoing connections on the MP+ are implicitly denied and firewall rules must be\nexplicitly requested. ",(0,i.yg)("inlineCode",{parentName:"p"},"10.0.0.0/8")," network access from within our sandbox is\nexplicitly denied."),(0,i.yg)("h4",{id:"requesting-firewall-rules"},"Requesting firewall rules"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Search for \u201cegress firewall rules OSD\u201d on Source"),(0,i.yg)("li",{parentName:"ol"},"Shiny link ",(0,i.yg)("em",{parentName:"li"},"opening a ticket")),(0,i.yg)("li",{parentName:"ol"},"You can take an inspiration from RITM1861658; almost all of our tickets for\nfirewall rules follow the template below.")),(0,i.yg)("h4",{id:"template-and-notes"},"Template and notes"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"\u2022 source: \u2039list the clusters here\u203a\n\u2022 destination: \u2039list of domains\u203a\n\u2022 protocol: 80, 443\n\u2022 justification: \u2039almost as our release notes\u203a\n(N clusters \xd7 M domains \xd7 P ports)\n")),(0,i.yg)("p",null,"If you want to include subdomains, I would recommend typing it as\n",(0,i.yg)("inlineCode",{parentName:"p"},".example.com"),", e.g. ",(0,i.yg)("inlineCode",{parentName:"p"},".kde.org"),"."),(0,i.yg)("p",null,"Don't forget to replace the ",(0,i.yg)("inlineCode",{parentName:"p"},"N"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"M"),", and ",(0,i.yg)("inlineCode",{parentName:"p"},"P")," with their respective values, it\nis used just as a check. You can also link the original issue with the waiting\nlist, not required though."),(0,i.yg)("p",null,"If you need to request outgoing SSH to be allowed (e.g. SSH access to git\nforges), don't forget to specify port 22 (which is the usual default), ",(0,i.yg)("strong",{parentName:"p"},"and"),"\ninstead of domain, give ",(0,i.yg)("strong",{parentName:"p"},"IP addresses"),". SSH access is bound by IPs rather than\ndomains (can be seen in the \u201cinspiration\u201d ticket mentioned above)."))}d.isMDXComponent=!0}}]);