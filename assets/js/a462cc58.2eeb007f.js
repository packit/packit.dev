"use strict";(self.webpackChunkpackit_dev=self.webpackChunkpackit_dev||[]).push([[8061],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>d});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),c=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=c(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=c(r),g=a,d=u["".concat(p,".").concat(g)]||u[g]||m[g]||o;return r?n.createElement(d,i(i({ref:t},l),{},{components:r})):n.createElement(d,i({ref:t},l))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=g;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},36598:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=r(87462),a=(r(67294),r(3905));const o={title:"Creating CentOS Stream 9 source-git repositories",sidebar_position:2},i="Creating CentOS Stream 9 source-git repositories",s={unversionedId:"creating-stream-9-repos",id:"creating-stream-9-repos",title:"Creating CentOS Stream 9 source-git repositories",description:"Source-git repos for CentOS Stream 9 are stored as separate repositories in",source:"@site/development/creating-stream-9-repos.md",sourceDirName:".",slug:"/creating-stream-9-repos",permalink:"/development/creating-stream-9-repos",draft:!1,editUrl:"https://github.com/packit/packit.dev/tree/main/development/creating-stream-9-repos.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Creating CentOS Stream 9 source-git repositories",sidebar_position:2},sidebar:"autogenerated",previous:{title:"How open is this service?",permalink:"/development/how-open-is-this-service"},next:{title:"Source-git patch metadata",permalink:"/development/patch-metadata"}},p={},c=[{value:"How to create such repo",id:"how-to-create-such-repo",level:2},{value:"Pushing the repository to GitLab",id:"pushing-the-repository-to-gitlab",level:2}],l={toc:c},u="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(u,(0,n.Z)({},l,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"creating-centos-stream-9-source-git-repositories"},"Creating CentOS Stream 9 source-git repositories"),(0,a.kt)("p",null,"Source-git repos for CentOS Stream 9 are stored as separate repositories in\n",(0,a.kt)("a",{parentName:"p",href:"https://gitlab.com/redhat/centos-stream/src"},"https://gitlab.com/redhat/centos-stream/src")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"c9s")," branches."),(0,a.kt)("p",null,"Here is how the repositories should be set up:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"They are open to the public (for contributions).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Issues are disabled (BZ is the official bug tracker).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Merge requests are enabled.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Description is set:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"Source repo for CentOS Stream package $package.\nYou can contribute here by following https://wiki.centos.org/Contribute/CentOSStream/\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"c9s")," branch is protected, though force-pushes are allowed from maintainers (for sake of rebasing)."))),(0,a.kt)("h2",{id:"how-to-create-such-repo"},"How to create such repo"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/docs/cli/source-git/init"},"using ",(0,a.kt)("inlineCode",{parentName:"a"},"packit source-git init"))),(0,a.kt)("h2",{id:"pushing-the-repository-to-gitlab"},"Pushing the repository to GitLab"),(0,a.kt)("p",null,"We have an identity,\n",(0,a.kt)("a",{parentName:"p",href:"https://gitlab.com/centos-stream-packit"},"centos-stream-packit"),", which has\npermissions to create new repositories in the namespace."),(0,a.kt)("p",null,"Here comes a sample script utilizing ogr and python-gitlab to create a new repo\nto satisfy the requirements above:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'import ogr\nimport os\n\nTARGET_GROUP = "redhat/centos-stream/src"\nGITLAB_TOKEN = os.getenv("GITLAB_TOKEN")\n\ngitlab_service = ogr.GitlabService(GITLAB_TOKEN)\ntarget_group = gitlab_service.gitlab_instance.groups.get(TARGET_GROUP)\n\nrepo_name = "edk2"\nproject = gitlab_service.gitlab_instance.projects.create({\n    "name": repo_name,\n    "namespace_id": target_group.id,\n    "description": (\n        f"Source repo for CentOS Stream package \\"{repo_name}\\". "\n        "You can contribute here by following https://wiki.centos.org/Contribute/CentOSStream/"\n    ),\n    "issues_enabled": False,\n    "visibility": "public",\n})\nproject.protectedbranches.create(\n    {"name": "c9s", "push_access_level": "40", "merge_access_level": "40"}\n)\n')))}m.isMDXComponent=!0}}]);