"use strict";(self.webpackChunkpackit_dev=self.webpackChunkpackit_dev||[]).push([[98907],{15680:(e,r,a)=>{a.d(r,{xA:()=>s,yg:()=>y});var t=a(96540);function n(e,r,a){return r in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function o(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?o(Object(a),!0).forEach((function(r){n(e,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))}))}return e}function p(e,r){if(null==e)return{};var a,t,n=function(e,r){if(null==e)return{};var a,t,n={},o=Object.keys(e);for(t=0;t<o.length;t++)a=o[t],r.indexOf(a)>=0||(n[a]=e[a]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],r.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=t.createContext({}),g=function(e){var r=t.useContext(l),a=r;return e&&(a="function"==typeof e?e(r):i(i({},r),e)),a},s=function(e){var r=g(e.components);return t.createElement(l.Provider,{value:r},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},c=t.forwardRef((function(e,r){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=g(a),c=n,y=m["".concat(l,".").concat(c)]||m[c]||u[c]||o;return a?t.createElement(y,i(i({ref:r},s),{},{components:a})):t.createElement(y,i({ref:r},s))}));function y(e,r){var a=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=c;var p={};for(var l in r)hasOwnProperty.call(r,l)&&(p[l]=r[l]);p.originalType=e,p[m]="string"==typeof e?e:n,i[1]=p;for(var g=2;g<o;g++)i[g]=a[g];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}c.displayName="MDXCreateElement"},62752:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>p,toc:()=>g});var t=a(58168),n=(a(96540),a(15680));const o={title:"RPKG",authors:"flachman"},i=void 0,p={unversionedId:"automation-tools/rpkg",id:"automation-tools/rpkg",title:"RPKG",description:"- base library for fedpkg provides common functionality for dist-git setups",source:"@site/research/automation-tools/rpkg.md",sourceDirName:"automation-tools",slug:"/automation-tools/rpkg",permalink:"/research/automation-tools/rpkg",draft:!1,editUrl:"https://github.com/packit/research/tree/main/research/automation-tools/rpkg.md",tags:[],version:"current",frontMatter:{title:"RPKG",authors:"flachman"},sidebar:"autogenerated",previous:{title:"RPKG-UTIL",permalink:"/research/automation-tools/rpkg-util"},next:{title:"TITO",permalink:"/research/automation-tools/tito"}},l={},g=[{value:"\u2795",id:"",level:2},{value:"\u2796",id:"-1",level:2},{value:"Requirements",id:"requirements",level:2},{value:"RPKG2",id:"rpkg2",level:2}],s={toc:g},m="wrapper";function u(e){let{components:r,...a}=e;return(0,n.yg)(m,(0,t.A)({},s,a,{components:r,mdxType:"MDXLayout"}),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"base library for fedpkg provides common functionality for dist-git setups"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://pagure.io/rpkg"}," \ud83d\udcbb pagure.io/rpkg"),", ",(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg"}," \ud83d\udcdc documentation")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("img",{parentName:"li",src:"https://img.shields.io/pypi/pyversions/rpkg.svg",alt:"PyPI - Python Version"}),", ",(0,n.yg)("a",{parentName:"li",href:"https://pypi.org/project/rpkg/"},(0,n.yg)("img",{parentName:"a",src:"https://img.shields.io/pypi/v/rpkg.svg",alt:"PyPI"})),", ",(0,n.yg)("a",{parentName:"li",href:"https://src.fedoraproject.org/rpms/rpkg"}," \ud83d\udce6 fedora packages"))),(0,n.yg)("h2",{id:""},"\u2795"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/cli.html#"},"CLI deffinition")," for tools build on top of the rpkg"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html"},"Python API"),", some examples:",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#cli"},"cli")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#commands"},"commands"),(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"add_tag(tagname, force=False, message=None, file=None)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"build(skip_tag=False, scratch=False, background=False, url=None, chain=None, arches=None, sets=False, nvr_check=True, fail_fast=False)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"container_build_koji(target_override=False, opts={}, kojiconfig=None, kojiprofile=None, build_client=None, koji_task_watcher=None, nowait=False, flatpak=False)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"copr_build(project, srpm_name, nowait, config_file)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"import_srpm(srpm)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"koji_upload(file, path, callback=None)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"patch(suffix, rediff=False)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"prep(arch=None, builddir=None, buildrootdir=None)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"switch_branch(branch, fetch=True)"),", ..."))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#lookaside"},"lookaside cache"),(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"download(name, filename, hash, outfile, hashtype=None, **kwargs)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"remote_file_exists(name, filename, hash)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"upload(name, filepath, hash)"),", ..."))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#sources"},"sources")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#gitignore"},"gitignore"))))),(0,n.yg)("h2",{id:"-1"},"\u2796"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},".")),(0,n.yg)("h2",{id:"requirements"},"Requirements"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"mock: for local mockbuild."),(0,n.yg)("li",{parentName:"ul"},"rpm-build: for local RPM build, which provides the command line rpm."),(0,n.yg)("li",{parentName:"ul"},"rpmlint: check SPEC."),(0,n.yg)("li",{parentName:"ul"},"copr-cli: for building package in Fedora Copr."),(0,n.yg)("li",{parentName:"ul"},"module-build-service: for building modules.")),(0,n.yg)("h2",{id:"rpkg2"},"RPKG2"),(0,n.yg)("p",null,"rpkg2 is a project forked from rpkg to introduce various major improvements and refactor in order to:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Modern modularization."),(0,n.yg)("li",{parentName:"ul"},"A real library for import from other projects to operate package repository or access package metadata."),(0,n.yg)("li",{parentName:"ul"},"Extensible for writing package client tool."),(0,n.yg)("li",{parentName:"ul"},"A framework to write subcommands in a decoupled way to build artifacts, including RPMs, modules, or containers."),(0,n.yg)("li",{parentName:"ul"},"Remove all deprecation and technical debt."),(0,n.yg)("li",{parentName:"ul"},"Python 3 default apparently.")),(0,n.yg)("p",null,"Examples:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},"from pyrpkg.pkgrepo import PackageRepository\nrepo = PackageRepository('/path/to/package')\nprint(repo.branch_merge)\nprint(repo.branch_remote)\nprint(repo.push_url)\nprint(repo.commit_hash)\n")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},"from pyrpkg.pkgrepo import PackageRepository\nfrom pyrpkg.pkginfo import PackageMetadata\n\nrepo = PackageRepository('/path/to/package')\npkg = PackageMetadata(repo)\nprint(pkg.ns)\nprint(pkg.ns_repo_name)\nprint(pkg.disttag)\nprint(pkg.spec)\n")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},"from pyrpkg.config import read_config\n\nconfig = read_config('/path/to/rpkg.config')\nprint(config.rpkg.anongiturl)\nprint(config.rpkg.distgit_namespaced)\n")),(0,n.yg)("p",null,"Two (probably mirrored) repositories:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://pagure.io/rpkg2"},"https://pagure.io/rpkg2")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://gitlab.com/rpkg/rpkg2"},"https://gitlab.com/rpkg/rpkg2"))),(0,n.yg)("p",null,"And the old github one:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://gitlab.com/rpkg/rpkg2"},"https://gitlab.com/rpkg/rpkg2"))),(0,n.yg)("p",null,"For the background, see ",(0,n.yg)("a",{parentName:"p",href:"https://pagure.io/rpkg/issue/49"},"this discussion")," and the ",(0,n.yg)("a",{parentName:"p",href:"https://fedoraproject.org/wiki/Thoughts_on_rpkg2"},"this wiki ",(0,n.yg)("inlineCode",{parentName:"a"},"Thoughts_on_rpkg2")),"."))}u.isMDXComponent=!0}}]);