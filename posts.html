<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-posts">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Blog | Packit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://packit.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://packit.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://packit.dev/posts"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | Packit"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://packit.dev/posts"><link data-rh="true" rel="alternate" href="https://packit.dev/posts" hreflang="en"><link data-rh="true" rel="alternate" href="https://packit.dev/posts" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://STHKG8EYKZ-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Packit" href="/opensearch.xml">







<link rel="alternate" type="application/rss+xml" href="/posts/rss.xml" title="Packit Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/posts/atom.xml" title="Packit Blog Atom Feed">
<link rel="alternate" type="application/json" href="/posts/feed.json" title="Packit Blog JSON Feed">
<link rel="alternate" type="application/rss+xml" href="/posts/weekly/rss.xml" title="Packit Weekly RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/posts/weekly/atom.xml" title="Packit Weekly Atom Feed">
<link rel="alternate" type="application/json" href="/posts/weekly/feed.json" title="Packit Weekly JSON Feed"><link rel="stylesheet" href="/assets/css/styles.3595ad89.css">
<link rel="preload" href="/assets/js/runtime~main.867e0844.js" as="script">
<link rel="preload" href="/assets/js/main.c3f0b2b4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Packit Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Packit Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Packit</b></a><a class="navbar__item navbar__link" href="/docs">Documentation</a><a class="navbar__item navbar__link" href="/source-git">Source-git</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/development">Development</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/deployment">Deployment</a></li><li><a class="dropdown__link" href="/research">Research</a></li><li><a class="dropdown__link" href="/agile">Agile</a></li><li><a class="dropdown__link" href="/specfile">specfile library</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/posts">Blog Posts</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/posts/weekly">Weekly Updates</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://dashboard.packit.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dashboard<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://status.packit.dev/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/packit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/aws-and-image-builder">Customize AWS cloud images with Image Builder and Packit</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/specfile-introduction">Introduction to specfile library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/experiences_with_rust">Experiences using Packit for a Rust executable Project</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/verify-sync-release-volunteers">Call for volunteers: help to test us the release syncing using staging instance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/manual-triggering">(Tests) job triggering improvements</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/aws-and-image-builder">Customize AWS cloud images with Image Builder and Packit</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-01-22T00:00:00.000Z" itemprop="datePublished">January 22, 2024</time> Â· <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/majamassarini" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/majamassarini.png" alt="Maja Massarini"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/majamassarini" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Maja Massarini</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Have you ever wanted to bring your pull request changes in a cloud image easily?
Curious about how easy it can be? With Packit, it can be just about commenting on your pull request with <code>/packit vm-image-build</code>.</p><p>With the above command, Packit automates all the manual steps needed to create an
RPM package with your pull request changes and asks the Image Builder to install it
inside a brand new cloud image.
Let&#x27;s have a look at the prerequisites for this.</p><h1>Join the Red Hat Developer Program</h1><p>If you don&#x27;t already have a business account you can create a
<em>Red Hat Developer account</em> at no cost <a href="https://developers.redhat.com/about" target="_blank" rel="noopener noreferrer">here</a>.</p><p>You need a subscription in order to use the
<a href="https://console.redhat.com/insights/image-builder" target="_blank" rel="noopener noreferrer">Image Builder service</a>
and launch the builded images in the <a href="https://aws.amazon.com/console/" target="_blank" rel="noopener noreferrer">AWS management console</a>.</p><h1>Prepare to upload AWS AMI images</h1><p>Before uploading an AWS AMI image, you must configure the AWS system for receiving them.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">â€‹</a></h3><ul><li>You must have an Access Key ID configured in the <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">AWS IAM account manager</a>.</li><li>You must have a writable <a href="https://docs.aws.amazon.com/AmazonS3/latest/gsg/CreatingABucket.html" target="_blank" rel="noopener noreferrer">S3 bucket</a> prepared.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="procedure">Procedure<a href="#procedure" class="hash-link" aria-label="Direct link to Procedure" title="Direct link to Procedure">â€‹</a></h3><p>Follow <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/composing_a_customized_rhel_system_image/creating-cloud-images-with-composer_composing-a-customized-rhel-system-image#preparing-for-uploading-aws-ami-images_creating-cloud-images-with-composer" target="_blank" rel="noopener noreferrer">these steps</a>
to satisfy the above prerequisites.</p><h1>The manual steps</h1><p>Are you wondering what are the manual steps for bringing your pull request changes
in a cloud image and why you should automate them?</p><p>There could be many ways to achieve this goal but let&#x27;s see together the closest to our
automated solution. Below you can find a summary of all the needed manual steps;
I am quite sure after reading them, you will want to automate them with Packit!</p><ul><li><p>Build an RPM package with your pull request changes through <strong>COPR</strong>, go to <a href="https://copr.fedorainfracloud.org" target="_blank" rel="noopener noreferrer">https://copr.fedorainfracloud.org</a></p><ol><li>Install <code>copr-cli</code>.</li><li>Create your account and service token.</li><li>Add your token to `~/.config/copr.</li><li>Create a new COPR project.</li><li>Start a build with your local pull request changes using <code>copr-cli</code>.</li><li><strong>WAIT for the build to finish</strong>.</li></ol></li><li><p>Create a new cloud image through the <strong>Image Builder console</strong>, go to <a href="https://console.redhat.com/insights/image-builder" target="_blank" rel="noopener noreferrer">https://console.redhat.com/insights/image-builder</a></p><ol start="7"><li>Login with your <em>Red Hat developer</em> account.</li><li>Click on the <code>Create Image</code> button, choose <em>AWS image</em> type and follow the wizard.</li><li><strong>WAIT for the build to finish</strong>.</li><li>Open the <code>Launch</code> link for the builded image.</li></ol></li><li><p>Launch and access the AWS image through the <strong>AWS management console</strong>, go to <a href="https://aws.amazon.com/console/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/console/</a></p><ol start="11"><li>The previous link will open an AWS console tab with the
<em>Launch an Instance</em> wizard preset to use the builded image.
You need to login into the <em>AWS management console</em> using an <em>AWS Account ID</em>
allowed to access the <em>AMI Image</em> you just created.</li><li>Select a <strong>Key pair</strong>, or create one if you don&#x27;t have it already,
to be able to ssh the image later.</li><li>Click on <code>Launch Instance</code></li><li>Connect to instance using an ssh client</li><li>Add the previously created COPR repo to the list of available dnf repositories.</li><li>Install the package you have created at step number 4.</li><li>Now you are ready to test your code in a real cloud image.</li></ol></li></ul><p>For every new pull request you want to test directly in a cloud image you have to repeat
steps 4-16 or automate them through Packit!</p><h1>Automate the steps</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-packit">Install Packit<a href="#install-packit" class="hash-link" aria-label="Direct link to Install Packit" title="Direct link to Install Packit">â€‹</a></h2><p>Installing Packit is pretty straightforward.</p><ol><li>Create a valid <a href="https://fedoraproject.org/wiki/Account_System" target="_blank" rel="noopener noreferrer">Fedora Account System (FAS)</a>
account (if you don&#x27;t already have one).
Why do you need it? After these few steps you will start building (and potentially shipping)
Fedora packages through the <a href="https://copr.fedorainfracloud.org/" target="_blank" rel="noopener noreferrer">COPR service</a> and we need you to agree with the Fedora license.</li><li>Install our GitHub application on <a href="https://github.com/marketplace/packit-as-a-service" target="_blank" rel="noopener noreferrer">GitHub Marketplace</a>,
or <a href="https://packit.dev/docs/guide/#how-to-set-up-packit-on-gitlab" target="_blank" rel="noopener noreferrer">configure a webhook</a> on GitLab
(depending on where your project lives).</li><li>Make Packit <a href="https://packit.dev/docs/guide/#2-approval" target="_blank" rel="noopener noreferrer">approve your FAS username</a>;
on Github the approval process is automated and for Gitlab you have to contact us.</li></ol><p>Now you are ready to automate the process as described below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-packit">Setup Packit<a href="#setup-packit" class="hash-link" aria-label="Direct link to Setup Packit" title="Direct link to Setup Packit">â€‹</a></h2><p>Create a <code>.packit.yaml</code> configuration file in your pull request.</p><p>But just the first time! After your pull request has been merged, Packit will take the <code>.packit.yaml</code> file from the target <em>main branch</em>.</p><p>The configuration file will look like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- job: copr_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trigger: pull_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  targets:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - fedora-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- job: vm_image_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trigger: pull_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    architecture: x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    upload_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        share_with_accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - &lt; shared-aws-account-id &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_distribution: fedora-39</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  copr_chroot: fedora-39-x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_customizations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    packages: [hello-world]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="copr_build-job">copr_build job<a href="#copr_build-job" class="hash-link" aria-label="Direct link to copr_build job" title="Direct link to copr_build job">â€‹</a></h3><p>The first job tells Packit service to build an RPM package, for the Fedora release you want,
in this example all the active fedora releases, and to add your pull request changes to the package.</p><p>To further customize the COPR builds made by Packit you may want to give a look at this
<a href="https://packit.dev/docs/configuration/upstream/copr_build" target="_blank" rel="noopener noreferrer">guide</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vm_image_build-job">vm_image_build job<a href="#vm_image_build-job" class="hash-link" aria-label="Direct link to vm_image_build job" title="Direct link to vm_image_build job">â€‹</a></h3><p>The second job tells Packit how to configure the Builder Image service.</p><p>The first two lines of this job are still meant for Packit;
they allow Packit to react to your pull request comment <code>/packit vm-image-build</code>.
Packit does not build a VM image automatically, as it does when it builds a COPR package,
to save you from no wanted costs.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- job: vm_image_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trigger: pull_request</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The other lines are meant to customize the Image Builder behaviour.</p><p>You are asking to build an <em>AWS</em> image, with a <em>fedora-39</em> distribution,
for the <em>x86_64</em> architecture and you want to share it with the listed
<em>AWS Account IDs</em>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">image_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  architecture: x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  upload_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      share_with_accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - &lt; shared-aws-account-id &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image_distribution: fedora-39</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You don&#x27;t want to manually install the COPR package into the image,
for this reason you ask the Image Builder to install it (<em>hello-world</em>).</p><p>You tell Image Builder to take it from the COPR chroot <em>fedora-39-x86_64</em>,
and you don&#x27;t need to create or specify a COPR project because it has
been automatically created by Packit for you.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">copr_chroot: fedora-39-x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image_customizations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  packages: [hello-world]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-comment-and-test-a-pull-request">Create, comment and test a pull request!<a href="#create-comment-and-test-a-pull-request" class="hash-link" aria-label="Direct link to Create, comment and test a pull request!" title="Direct link to Create, comment and test a pull request!">â€‹</a></h2><p>Create a pull request, mine will show you the <strong>world</strong> word in green ðŸŒ¿.</p><p>You are ready to go, just comment your pull request with</p><p><code>/packit vm-image-build</code></p><p>and the image will be built and customized for you.</p><p>Look for the check named <strong>vm-image-build-fedora-39-x86_64</strong>
and wait for it to finish.</p><p><img loading="lazy" alt="Wait for check vm-image-build-fedora-39-x86_64 to finish" src="/assets/images/checks_vm_image_build-0ec652132670f4da590dca9dc372a468.png" width="512" height="194" class="img_ev3q"></p><p>Open its details and you will find the link
to the AWS image.</p><p><img loading="lazy" alt="The check details have a link to the AWS image" src="/assets/images/link_to_aws_image-16f87362483365f8530c80041de39ada.png" width="512" height="198" class="img_ev3q"></p><p>Open the AWS link (you need to be already logged in) and
see the details of your image ready to be launched.</p><p><img loading="lazy" alt="The AWS image details" src="/assets/images/ami-link-2bb9d9e9a1da6c8e18ca31b39db13789.png" width="512" height="246" class="img_ev3q"></p><p>Launch your image instance and connect to it.</p><p><img loading="lazy" alt="Connect to instance details" src="/assets/images/connect-to-instance-0f2ae4856b17566477e3e4e29074075f.png" width="512" height="393" class="img_ev3q"></p><p>Test it!</p><p><img loading="lazy" alt="Test it!" src="/assets/images/hello-world-809c7da500a4aca0a1d5b7fbdd3ea1fc.png" width="495" height="94" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/image-builder">image-builder</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/specfile-introduction">Introduction to specfile library</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-01-12T00:00:00.000Z" itemprop="datePublished">January 12, 2024</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/nforro" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/nforro.png" alt="Nikola ForrÃ³"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/nforro" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nikola ForrÃ³</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Have you ever wanted to make changes in an RPM spec file programmatically? <em>specfile</em> library
has been created for that very purpose. It is a pure Python library that allows you to conveniently
edit different parts of a spec file while doing its best to keep the resulting changeset minimal
(no unnecessary whitespace changes etc.).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">â€‹</a></h2><p>The library is packaged for Fedora, EPEL 9 and EPEL 8 and you can simply install it with dnf:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> python3-specfile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On other systems, you can use pip (just note that it requires RPM Python bindings to be installed):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> specfile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">â€‹</a></h2><p>Let&#x27;s have a look at a few simple examples of how to use the library.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bumping-release">Bumping release<a href="#bumping-release" class="hash-link" aria-label="Direct link to Bumping release" title="Direct link to Bumping release">â€‹</a></h3><p>To bump release and add a new changelog entry, we could use the following code:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> specfile </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Specfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> Specfile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;example.spec&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">release </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">expanded_release</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_changelog_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;- Bumped release for test purposes&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s take a look at what happens here:</p><p>We instantiate <code>Specfile</code> class with a path to our spec file and use it as a context manager
to automatically save all changes upon exiting the context.</p><p>We then use <code>expanded_release</code> property to get the current value of <code>Release</code> tag after macro expansion.
We assume it is numeric, so we simply convert it to integer, add 1, convert the result back to string
and assign the new value to <code>release</code> property.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Note that <code>release</code>/<code>expanded_release</code> properties exclude dist tag (usually <code>%{?dist}</code>) - for convenience,
it is ignored when reading and preserved unmodified when writing. If that&#x27;s not what you want, you can use
<code>raw_release</code>/<code>expanded_raw_release</code> properties instead.</p></div></div><p>Finally, we add a new changelog entry. We don&#x27;t specify any other arguments but content,
so the author is determined automatically using the same procedure as <code>rpmdev-packager</code> uses
and date is set to current day.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="switching-to-autochangelog">Switching to <code>%autochangelog</code><a href="#switching-to-autochangelog" class="hash-link" aria-label="Direct link to switching-to-autochangelog" title="Direct link to switching-to-autochangelog">â€‹</a></h3><p>To make a switch from traditional changelog to <code>%autochangelog</code>, we could do the following:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pathlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> specfile </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Specfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Specfile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;example.spec&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> autosave</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sections</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entries </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">changelog</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">changelog</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;%autochangelog&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pathlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;changelog&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entries</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s take a look at what happens here:</p><p>We instantiate <code>Specfile</code> class with a path to our spec file and we also set <code>autosave</code> argument
that ensures that any changes are saved automatically as soon as possible.</p><p><em>specfile</em> heavily relies on context managers. Here we are using <code>sections()</code> method that returns
a context manager that we can use to manipulate spec file sections. Upon exiting the context,
any modifications done are propagated to the internal representation stored in our <code>Specfile</code> instance,
and since <code>autosave</code> is set, they are immediately saved to the spec file as well.</p><p>First, we store a copy of the content of the <code>%changelog</code> section. The content is represented
as a list of lines.</p><p>Then we replace the content with a single line - &quot;%autochangelog&quot;.</p><p>Finally, we save the stored content into a &quot;changelog&quot; file.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iterating-through-tags">Iterating through tags<a href="#iterating-through-tags" class="hash-link" aria-label="Direct link to Iterating through tags" title="Direct link to Iterating through tags">â€‹</a></h3><p>Contexts can be nested. Here is a code that iterates through all <em>package</em> sections
(including the first, implicitly named one; also known as <em>preamble</em>) and prints expanded value
of all <code>Requires</code> tags:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Specfile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;example.spec&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sections</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> section </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># normalized name of a section is lowercased</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> section</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normalized_name </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;package&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> spec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">section</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> tag </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># normalized name of a tag is capitalized</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> tag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normalized_name </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Requires&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Section: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">section</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation builtin">id</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, Tag: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tag</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, Value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tag</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">expanded_value</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s take a look at what happens here:</p><p>We instantiate <code>Specfile</code> class with a path to our spec file. This time we don&#x27;t set <code>autosave</code> because
we are not doing any modifications (though we could still save any changes explicitly using <code>save()</code> method).</p><p>Then we use <code>sections()</code> context manager and iterate through sections; we skip sections not called &quot;package&quot;
(the initial <em>%</em> is ommited for convenience).</p><p>After that we use <code>tags()</code> context manager and pass the current section as an argument. This allows us
to iterate through tags in the current section. Without any argument, we would get a list of tags in <em>preamble</em>,
the very first section in a spec file. We skip tags not called &quot;Requires&quot; and finally print the values
of <code>Requires</code> tags after macro expansion. We also print tag names (not normalized) and section IDs - those are
section names followed by options, e.g. &quot;package -n alternative-name-for-example&quot;.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-info-and-links">More info and links<a href="#more-info-and-links" class="hash-link" aria-label="Direct link to More info and links" title="Direct link to More info and links">â€‹</a></h2><p>Are you interested in more details, trying the library out or even contributing? You can find <em>specfile</em> source code on <a href="https://github.com/packit/specfile" target="_blank" rel="noopener noreferrer">GitHub</a>.
See the <a href="https://github.com/packit/specfile/blob/main/README.md" target="_blank" rel="noopener noreferrer">README</a> for more tips and usage examples.
You can also check out the <a href="https://packit.dev/specfile/api/specfile" target="_blank" rel="noopener noreferrer">API reference</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/specfile">specfile</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/experiences_with_rust">Experiences using Packit for a Rust executable Project</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-10-10T00:00:00.000Z" itemprop="datePublished">October 10, 2023</time> Â· <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mulkieran" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mulkieran.png" alt="mulhern"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mulkieran" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">mulhern</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>&quot;How absurdly simple!&quot; I cried.</p><p>&quot;Quite so!&quot; said he, a little nettled. &quot;Every problem becomes very childish when once it is explained to you.&quot;</p><ul><li>Arthur Conan Doyle, &quot;The Adventure of the Dancing Men&quot;</li></ul><p>We have planned for a while to use Packit to generate packages on Copr
on demand for our somewhat complicated Rust executable, stratisd. It
looked like this was going to be challenging, and in a sense it was,
but once the task was completed, it turned out to have been pretty
straightforward.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about Experiences using Packit for a Rust executable Project" href="/posts/experiences_with_rust"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/verify-sync-release-volunteers">Call for volunteers: help to test us the release syncing using staging instance</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-09-05T12:46:18.000Z" itemprop="datePublished">September 5, 2023</time> Â· <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lbarcziova.png" alt="Laura BarcziovÃ¡"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Laura BarcziovÃ¡</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>In the upcoming months, we plan to migrate our service to a new cluster. However, this may affect <code>propose_downstream</code>
and <code>pull_from_upstream</code> jobs due to the new firewall rules. The problematic aspects could be:</p><ul><li>commands you run in your <code>actions</code> during syncing the release involving interactions with external servers</li><li>downloading your sources from various hosting services (crates.io, npm, gems, etc.)</li></ul><p>To smoothen this transition, we kindly encourage you to enable one of these jobs on our already migrated staging instance.
This recommendation is particularly important if you belong to one of the groups affected by the two previous points.
This proactive step will help us identify and address any issues promptly.</p><p>Both instances can be run at the same time and the behaviour can be configured via the <code>packit_instances</code> configuration key,
which is by default set to <code>[&quot;prod&quot;]</code>. Picking just one instance is required only for <code>koji_build</code> and <code>bodhi_update</code> jobs since
both instances work with the production instances of Fedora systems. To avoid too much noise in your dist-git PRs, you
may enable the <code>pull_from_upstream</code>/<code>propose_downstream</code> job for only one target, resulting in only one additional PR created.</p><p>Here&#x27;s how you can enable one of the jobs on the staging instance:</p><ul><li><code>pull-from-upstream</code>:
The only thing needed is to duplicate the job in your Packit config using <code>packit_instances</code> configuration option. Example:</li></ul><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pull_from_upstream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">trigger</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">packit_instances</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;stg&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">dist_git_branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> fedora</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rawhide</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>propose-downstream</code>:
For this job, you first need to <a href="/docs/guide#staging-instance">enable our staging Github app</a>
(you should be already automatically approved if you had been previously approved for production instance).
After that, similarly to <code>pull-from-upstream</code>, you only need to duplicate the job in your Packit config using <code>packit_instances</code>. Example:</li></ul><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> propose_downstream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">trigger</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">packit_instances</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;stg&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">dist_git_branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> fedora</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rawhide</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>When merging the PRs created by Packit, please don&#x27;t forget to merge the PRs created by the production instance
if you have a follow-up <code>koji_build</code> job enabled to ensure your builds will not be skipped
(or you can allow builds for staging instance as well, see <a href="/docs/configuration/downstream/koji_build#optional-parameters">allowed_pr_authors</a>)).</p></div></div><p>We would be happy if you could then report any problems to <a href="#contact">us</a>. We appreciate your collaboration in ensuring a seamless migration. Your Packit team!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/downstream">downstream</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/pull-from-upstream">pull-from-upstream</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/propose-downstream">propose-downstream</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/staging">staging</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/manual-triggering">(Tests) job triggering improvements</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-11T06:46:18.000Z" itemprop="datePublished">July 11, 2023</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lbarcziova.png" alt="Laura BarcziovÃ¡"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Laura BarcziovÃ¡</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Recently, we received multiple contributions from the Strimzi team, specifically <a href="https://github.com/Frawless" target="_blank" rel="noopener noreferrer">Jakub Stejskal</a>
and <a href="https://github.com/kornys" target="_blank" rel="noopener noreferrer">David Kornel</a>,
for the functionality of manual triggering of jobs and other related improvements, mostly focusing on the testing
UX. We are very happy about these and would like to showcase the results of their awesome contributions.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/configuration">configuration</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about (Tests) job triggering improvements" href="/posts/manual-triggering"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/monorepos">Introducing monorepository support</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-04T07:20:06.000Z" itemprop="datePublished">July 4, 2023</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lbarcziova.png" alt="Laura BarcziovÃ¡"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Laura BarcziovÃ¡</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>We are very happy to announce a major enhancement to Packit! We have now added support for
monorepositories, enabling the integration of upstream repositories containing multiple downstream packages.
If you have a repository in the monorepo format, Packit can now help you automate the integration to downstream
distributions both from CLI and as a service.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/monorepos">monorepos</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Introducing monorepository support" href="/posts/monorepos"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/release-field-handling">Handling of Release field in propose_downstream job</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-05-23T12:00:00.000Z" itemprop="datePublished">May 23, 2023</time> Â· <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/nforro" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/nforro.png" alt="Nikola ForrÃ³"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/nforro" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nikola ForrÃ³</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>We have recently made some fixes to the process of handling the <code>Release</code> field regarding the <code>%autorelease</code> macro, so let&#x27;s take that opportunity to explain how it works.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/specfile">specfile</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/propose-downstream">propose-downstream</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Handling of Release field in propose_downstream job" href="/posts/release-field-handling"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/pre-commit-hooks">Packit&#x27;s pre-commit hooks</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-05-16T11:00:00.000Z" itemprop="datePublished">May 16, 2023</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/jpopelka" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/jpopelka.png" alt="JiÅ™Ã­ Popelka"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/jpopelka" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">JiÅ™Ã­ Popelka</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="https://pre-commit.com" target="_blank" rel="noopener noreferrer">pre-commit</a> is a wonderful tool that saves you
a lot of time by automatically checking your changes before you
commit and/or push them out.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/workflow">workflow</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Packit&#x27;s pre-commit hooks" href="/posts/pre-commit-hooks"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/2022-features">2022 for Packit</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-01-28T10:58:50.000Z" itemprop="datePublished">January 28, 2023</time> Â· <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/lachmanfrantisek" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lachmanfrantisek.png" alt="FrantiÅ¡ek Lachman"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/lachmanfrantisek" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">FrantiÅ¡ek Lachman</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>As you will see in the following paragraphs, the year 2022 was really fruitful for the Packit project. Without further ado, letâ€™s take a look at what the Packit team accomplished last year!</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/2022">2022</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/yearly-features">yearly-features</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/summary">summary</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 2022 for Packit" href="/posts/2022-features"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/posts/pull-from-upstream">Automatic pulling of upstream releases to Fedora</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-01-23T08:23:44.000Z" itemprop="datePublished">January 23, 2023</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lbarcziova.png" alt="Laura BarcziovÃ¡"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/lbarcziova" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Laura BarcziovÃ¡</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>In the previous year, we <a href="/posts/downstream-automation">automated</a> the Fedora downstream release process in Packit.
The first step of the release process, propagating the upstream release to Fedora,
is covered by the <a href="/docs/configuration/upstream/propose_downstream"><code>propose_downstream</code></a> job.
This job updates the sources in Fedora, the spec file, and other needed files and creates pull requests with the changes
in the dist-git repository.</p><p>The downside of this job is that for its execution, users need to install Packit Service GitHub/GitLab
app since this job reacts only to GitHub/GitLab release webhooks.
However, the person who maintains the package in Fedora may not be the upstream maintainer and may not have admin access
to the upstream GitHub/GitLab repository.</p><p>To cover this case, we came up with a new job called <code>pull_from_upstream</code>, which aims to update Fedora dist-git similarly
to <code>propose_downstream</code>, but is configured directly in the dist-git repository.
Let&#x27;s now look at how to set it up and how it works.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/downstream">downstream</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Automatic pulling of upstream releases to Fedora" href="/posts/pull-from-upstream"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/posts/page/2"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/guide">Onboarding guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/fedora-releases-guide">Fedora releases guide</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item">
                  <a href="https://chat.fedoraproject.org/#/room/#packit:fedora.im">
                    #packit:fedora.im
                  </a> (Element / Matrix)
                </li><li class="footer__item">
                  <a href="mailto:hello@packit.dev">hello@packit.dev</a>
                </li><li class="footer__item">
                  <a href="https://fosstodon.org/@packit" rel="me">
                    @packit@fosstodon.org
                  </a> (Mastodon)
                </li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/usage">Usage Charts</a></li><li class="footer__item"><a class="footer__link-item" href="/posts">Blog Posts</a></li><li class="footer__item"><a href="https://github.com/packit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 Packit is a Red Hat sponsored free software project. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.867e0844.js"></script>
<script src="/assets/js/main.c3f0b2b4.js"></script>
</body>
</html>