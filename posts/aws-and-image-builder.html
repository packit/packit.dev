<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-posts">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Customize AWS cloud images with Image Builder and Packit | Packit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://packit.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://packit.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://packit.dev/posts/aws-and-image-builder"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Customize AWS cloud images with Image Builder and Packit | Packit"><meta data-rh="true" name="description" content="Have you ever wanted to bring your pull request changes in a cloud image easily?"><meta data-rh="true" property="og:description" content="Have you ever wanted to bring your pull request changes in a cloud image easily?"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-22T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/majamassarini"><meta data-rh="true" property="article:tag" content="image-builder"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://packit.dev/posts/aws-and-image-builder"><link data-rh="true" rel="alternate" href="https://packit.dev/posts/aws-and-image-builder" hreflang="en"><link data-rh="true" rel="alternate" href="https://packit.dev/posts/aws-and-image-builder" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://STHKG8EYKZ-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Packit" href="/opensearch.xml">







<link rel="alternate" type="application/rss+xml" href="/posts/rss.xml" title="Packit Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/posts/atom.xml" title="Packit Blog Atom Feed">
<link rel="alternate" type="application/json" href="/posts/feed.json" title="Packit Blog JSON Feed">
<link rel="alternate" type="application/rss+xml" href="/posts/weekly/rss.xml" title="Packit Weekly RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/posts/weekly/atom.xml" title="Packit Weekly Atom Feed">
<link rel="alternate" type="application/json" href="/posts/weekly/feed.json" title="Packit Weekly JSON Feed"><link rel="stylesheet" href="/assets/css/styles.ad3a8798.css">
<link rel="preload" href="/assets/js/runtime~main.a861477e.js" as="script">
<link rel="preload" href="/assets/js/main.bac336b5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Packit Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Packit Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Packit</b></a><a class="navbar__item navbar__link" href="/docs">Documentation</a><a class="navbar__item navbar__link" href="/source-git">Source-git</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/development">Development</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/deployment">Deployment</a></li><li><a class="dropdown__link" href="/research">Research</a></li><li><a class="dropdown__link" href="/agile">Agile</a></li><li><a class="dropdown__link" href="/specfile">specfile library</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/posts">Blog Posts</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/posts/weekly">Weekly Updates</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://dashboard.packit.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dashboard<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://status.packit.dev/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/packit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/specfile-advanced">Advanced usage of the specfile library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/packit-in-2024">Packit in 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/packit_1_0_0_action_required">Packit 1.0.0 countdown - action may be required</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/project-mycorrhiza">Packit dashboard and Project Mycorrhiza</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/posts/non-divergent-dist-git-branches">No more divergent dist-git branches with Packit!</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Customize AWS cloud images with Image Builder and Packit</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-01-22T00:00:00.000Z" itemprop="datePublished">January 22, 2024</time> Â· <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/majamassarini" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/majamassarini.png" alt="Maja Massarini"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/majamassarini" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Maja Massarini</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Have you ever wanted to bring your pull request changes in a cloud image easily?
Curious about how easy it can be? With Packit, it can be just about commenting on your pull request with <code>/packit vm-image-build</code>.</p><p>With the above command, Packit automates all the manual steps needed to create an
RPM package with your pull request changes and asks the Image Builder to install it
inside a brand new cloud image.
Let&#x27;s have a look at the prerequisites for this.</p><h1>Join the Red Hat Developer Program</h1><p>If you don&#x27;t already have a business account you can create a
<em>Red Hat Developer account</em> at no cost <a href="https://developers.redhat.com/about" target="_blank" rel="noopener noreferrer">here</a>.</p><p>You need a subscription in order to use the
<a href="https://console.redhat.com/insights/image-builder" target="_blank" rel="noopener noreferrer">Image Builder service</a>
and launch the builded images in the <a href="https://aws.amazon.com/console/" target="_blank" rel="noopener noreferrer">AWS management console</a>.</p><h1>Prepare to upload AWS AMI images</h1><p>Before uploading an AWS AMI image, you must configure the AWS system for receiving them.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">â€‹</a></h3><ul><li>You must have an Access Key ID configured in the <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">AWS IAM account manager</a>.</li><li>You must have a writable <a href="https://docs.aws.amazon.com/AmazonS3/latest/gsg/CreatingABucket.html" target="_blank" rel="noopener noreferrer">S3 bucket</a> prepared.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="procedure">Procedure<a href="#procedure" class="hash-link" aria-label="Direct link to Procedure" title="Direct link to Procedure">â€‹</a></h3><p>Follow <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/composing_a_customized_rhel_system_image/creating-cloud-images-with-composer_composing-a-customized-rhel-system-image#preparing-for-uploading-aws-ami-images_creating-cloud-images-with-composer" target="_blank" rel="noopener noreferrer">these steps</a>
to satisfy the above prerequisites.</p><h1>The manual steps</h1><p>Are you wondering what are the manual steps for bringing your pull request changes
in a cloud image and why you should automate them?</p><p>There could be many ways to achieve this goal but let&#x27;s see together the closest to our
automated solution. Below you can find a summary of all the needed manual steps;
I am quite sure after reading them, you will want to automate them with Packit!</p><ul><li><p>Build an RPM package with your pull request changes through <strong>COPR</strong>, go to <a href="https://copr.fedorainfracloud.org" target="_blank" rel="noopener noreferrer">https://copr.fedorainfracloud.org</a></p><ol><li>Install <code>copr-cli</code>.</li><li>Create your account and service token.</li><li>Add your token to `~/.config/copr.</li><li>Create a new COPR project.</li><li>Start a build with your local pull request changes using <code>copr-cli</code>.</li><li><strong>WAIT for the build to finish</strong>.</li></ol></li><li><p>Create a new cloud image through the <strong>Image Builder console</strong>, go to <a href="https://console.redhat.com/insights/image-builder" target="_blank" rel="noopener noreferrer">https://console.redhat.com/insights/image-builder</a></p><ol start="7"><li>Login with your <em>Red Hat developer</em> account.</li><li>Click on the <code>Create Image</code> button, choose <em>AWS image</em> type and follow the wizard.</li><li><strong>WAIT for the build to finish</strong>.</li><li>Open the <code>Launch</code> link for the builded image.</li></ol></li><li><p>Launch and access the AWS image through the <strong>AWS management console</strong>, go to <a href="https://aws.amazon.com/console/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/console/</a></p><ol start="11"><li>The previous link will open an AWS console tab with the
<em>Launch an Instance</em> wizard preset to use the builded image.
You need to login into the <em>AWS management console</em> using an <em>AWS Account ID</em>
allowed to access the <em>AMI Image</em> you just created.</li><li>Select a <strong>Key pair</strong>, or create one if you don&#x27;t have it already,
to be able to ssh the image later.</li><li>Click on <code>Launch Instance</code></li><li>Connect to instance using an ssh client</li><li>Add the previously created COPR repo to the list of available dnf repositories.</li><li>Install the package you have created at step number 4.</li><li>Now you are ready to test your code in a real cloud image.</li></ol></li></ul><p>For every new pull request you want to test directly in a cloud image you have to repeat
steps 4-16 or automate them through Packit!</p><h1>Automate the steps</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-packit">Install Packit<a href="#install-packit" class="hash-link" aria-label="Direct link to Install Packit" title="Direct link to Install Packit">â€‹</a></h2><p>Installing Packit is pretty straightforward.</p><ol><li>Create a valid <a href="https://fedoraproject.org/wiki/Account_System" target="_blank" rel="noopener noreferrer">Fedora Account System (FAS)</a>
account (if you don&#x27;t already have one).
Why do you need it? After these few steps you will start building (and potentially shipping)
Fedora packages through the <a href="https://copr.fedorainfracloud.org/" target="_blank" rel="noopener noreferrer">COPR service</a> and we need you to agree with the Fedora license.</li><li>Install our GitHub application on <a href="https://github.com/marketplace/packit-as-a-service" target="_blank" rel="noopener noreferrer">GitHub Marketplace</a>,
or <a href="https://packit.dev/docs/guide/#how-to-set-up-packit-on-gitlab" target="_blank" rel="noopener noreferrer">configure a webhook</a> on GitLab
(depending on where your project lives).</li><li>Make Packit <a href="https://packit.dev/docs/guide/#2-approval" target="_blank" rel="noopener noreferrer">approve your FAS username</a>;
on Github the approval process is automated and for Gitlab you have to contact us.</li></ol><p>Now you are ready to automate the process as described below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-packit">Setup Packit<a href="#setup-packit" class="hash-link" aria-label="Direct link to Setup Packit" title="Direct link to Setup Packit">â€‹</a></h2><p>Create a <code>.packit.yaml</code> configuration file in your pull request.</p><p>But just the first time! After your pull request has been merged, Packit will take the <code>.packit.yaml</code> file from the target <em>main branch</em>.</p><p>The configuration file will look like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- job: copr_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trigger: pull_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  targets:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - fedora-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- job: vm_image_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trigger: pull_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    architecture: x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    upload_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        share_with_accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - &lt; shared-aws-account-id &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_distribution: fedora-39</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  copr_chroot: fedora-39-x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_customizations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    packages: [hello-world]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="copr_build-job">copr_build job<a href="#copr_build-job" class="hash-link" aria-label="Direct link to copr_build job" title="Direct link to copr_build job">â€‹</a></h3><p>The first job tells Packit service to build an RPM package, for the Fedora release you want,
in this example all the active fedora releases, and to add your pull request changes to the package.</p><p>To further customize the COPR builds made by Packit you may want to give a look at this
<a href="https://packit.dev/docs/configuration/upstream/copr_build" target="_blank" rel="noopener noreferrer">guide</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vm_image_build-job">vm_image_build job<a href="#vm_image_build-job" class="hash-link" aria-label="Direct link to vm_image_build job" title="Direct link to vm_image_build job">â€‹</a></h3><p>The second job tells Packit how to configure the Builder Image service.</p><p>The first two lines of this job are still meant for Packit;
they allow Packit to react to your pull request comment <code>/packit vm-image-build</code>.
Packit does not build a VM image automatically, as it does when it builds a COPR package,
to save you from no wanted costs.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- job: vm_image_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trigger: pull_request</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The other lines are meant to customize the Image Builder behaviour.</p><p>You are asking to build an <em>AWS</em> image, with a <em>fedora-39</em> distribution,
for the <em>x86_64</em> architecture and you want to share it with the listed
<em>AWS Account IDs</em>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">image_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  architecture: x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image_type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  upload_request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      share_with_accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - &lt; shared-aws-account-id &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image_distribution: fedora-39</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You don&#x27;t want to manually install the COPR package into the image,
for this reason you ask the Image Builder to install it (<em>hello-world</em>).</p><p>You tell Image Builder to take it from the COPR chroot <em>fedora-39-x86_64</em>,
and you don&#x27;t need to create or specify a COPR project because it has
been automatically created by Packit for you.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">copr_chroot: fedora-39-x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image_customizations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  packages: [hello-world]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-comment-and-test-a-pull-request">Create, comment and test a pull request!<a href="#create-comment-and-test-a-pull-request" class="hash-link" aria-label="Direct link to Create, comment and test a pull request!" title="Direct link to Create, comment and test a pull request!">â€‹</a></h2><p>Create a pull request, mine will show you the <strong>world</strong> word in green ðŸŒ¿.</p><p>You are ready to go, just comment your pull request with</p><p><code>/packit vm-image-build</code></p><p>and the image will be built and customized for you.</p><p>Look for the check named <strong>vm-image-build-fedora-39-x86_64</strong>
and wait for it to finish.</p><p><img loading="lazy" alt="Wait for check vm-image-build-fedora-39-x86_64 to finish" src="/assets/images/checks_vm_image_build-0ec652132670f4da590dca9dc372a468.png" width="512" height="194" class="img_ev3q"></p><p>Open its details and you will find the link
to the AWS image.</p><p><img loading="lazy" alt="The check details have a link to the AWS image" src="/assets/images/link_to_aws_image-16f87362483365f8530c80041de39ada.png" width="512" height="198" class="img_ev3q"></p><p>Open the AWS link (you need to be already logged in) and
see the details of your image ready to be launched.</p><p><img loading="lazy" alt="The AWS image details" src="/assets/images/ami-link-2bb9d9e9a1da6c8e18ca31b39db13789.png" width="512" height="246" class="img_ev3q"></p><p>Launch your image instance and connect to it.</p><p><img loading="lazy" alt="Connect to instance details" src="/assets/images/connect-to-instance-0f2ae4856b17566477e3e4e29074075f.png" width="512" height="393" class="img_ev3q"></p><p>Test it!</p><p><img loading="lazy" alt="Test it!" src="/assets/images/hello-world-809c7da500a4aca0a1d5b7fbdd3ea1fc.png" width="495" height="94" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/posts/tags/image-builder">image-builder</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/packit/packit.dev/tree/main/posts/aws-and-image-builder/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/posts/devconf-2024"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">DevConf.CZ 2024 and week around for Packit</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/posts/specfile-introduction"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Introduction to specfile library</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#procedure" class="table-of-contents__link toc-highlight">Procedure</a></li><li><a href="#install-packit" class="table-of-contents__link toc-highlight">Install Packit</a></li><li><a href="#setup-packit" class="table-of-contents__link toc-highlight">Setup Packit</a><ul><li><a href="#copr_build-job" class="table-of-contents__link toc-highlight">copr_build job</a></li><li><a href="#vm_image_build-job" class="table-of-contents__link toc-highlight">vm_image_build job</a></li></ul></li><li><a href="#create-comment-and-test-a-pull-request" class="table-of-contents__link toc-highlight">Create, comment and test a pull request!</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/guide">Onboarding guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/fedora-releases-guide">Fedora releases guide</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item">
                  <a href="https://matrix.to/#/#packit:fedora.im?web-instance[element.io]=chat.fedoraproject.org">
                    #packit:fedora.im
                  </a> (Matrix)
                </li><li class="footer__item">
                  <a href="mailto:hello@packit.dev">hello@packit.dev</a>
                </li><li class="footer__item">
                  <a href="https://fosstodon.org/@packit" rel="me">
                    @packit@fosstodon.org
                  </a> (Mastodon)
                </li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/usage">Usage Charts</a></li><li class="footer__item"><a class="footer__link-item" href="/posts">Blog Posts</a></li><li class="footer__item"><a href="https://github.com/packit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Packit is a Red Hat sponsored free software project. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a861477e.js"></script>
<script src="/assets/js/main.bac336b5.js"></script>
</body>
</html>